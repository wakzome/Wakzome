<!DOCTYPE html>
<!-- saved from url=(0062)file:///C:/Users/Wakzo/OneDrive/GOOGLE%20DRIVE/Wakzome/85.html -->
<html lang="es"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Horario Semanal</title>
<script src="./85_files/papaparse.min.js.transferir"></script>

<link rel="preload" href="https://raw.githubusercontent.com/wakzome/Wakzome/main/Montserrat-Light.ttf.ttf" as="font" type="font/ttf" crossorigin="">
<style>
@font-face {
    font-family: 'MontserratLight';
    src: url('https://raw.githubusercontent.com/wakzome/Wakzome/main/Montserrat-Light.ttf.ttf') format('truetype');
    font-weight: 100;
    font-style: normal;
    font-display: block;
}

html, body {
    margin:0;
    padding:0;
    height:100%;
    font-family:'MontserratLight', sans-serif;
    background:#fff;
    color:#000000; 
}

body {
    display:flex;
    flex-direction:column;
    justify-content:flex-end; /* empuja la tabla hacia abajo */
}

h1 {
    text-align:center;
    text-transform:lowercase;
    margin:16px 0;
    font-size:1.5rem;
    font-weight:bold;
    color:#000000;
}

.table-wrap {
    overflow-x:auto;
    overflow-y:hidden; /* no scroll vertical */
    display:block;
    width:100%;
}

table {
    width:100%;
    border-collapse:separate;
    border-spacing:0;
    table-layout:fixed;
    border-radius:15px;
    font-family:'MontserratLight', sans-serif;
    color:#000000;
}

th, td {
    border:1px solid #e6e6e6;
    padding:5px 6px;
    text-align:center;
    vertical-align:middle;
    font-size:0.9rem;
    font-weight:bold;
    color:#000000;
}

th {
    background:#f6f6f6;
    text-transform:uppercase;
    font-size:0.8rem;
    position:sticky;
    top:0;
    z-index:2;
}

td.name {
    width:60%;
    white-space:nowrap;
    text-align:center;
    border-radius:15px 0 0 15px;
    background:#f5f5f5;
}

td.multi-line {
    white-space:pre-line;
    font-weight:bold;
    color:#000000;
    background:#f5f5f5;
}

td.bold-row {
    font-weight:bold;
    color:#000000;
    background:#fff;
}

tr:nth-child(even) td:not(.name):not(.multi-line) {
    background:#fcfcfc;
}

tr:hover td {
    background:#eaeaea;
}

td, th {
    border-radius:10px;
    margin:2px;
}

td:not(.name), th:not(:first-child) {
    width:8.57%;
}
</style>
</head>
<body>

<h1>Horario Semanal</h1>
<div class="table-wrap" id="table-container">
  <div>Loading...</div>
</div>

<script>
(async function(){
  const csvUrl = 'https://raw.githubusercontent.com/wakzome/Wakzome/main/datosfnc.csv';
  let csvText = '';
  try {
    const res = await fetch(csvUrl);
    if(!res.ok) throw new Error('HTTP ' + res.status);
    csvText = await res.text();
  } catch(err){
    document.getElementById('table-container').innerHTML = 'Error cargando CSV: '+err.message;
    return;
  }

  const parsed = Papa.parse(csvText, {skipEmptyLines:false});
  let rows = parsed.data.map(r => r.map(c => (c===undefined||c===null)?'':String(c).trim()));

  while(rows.length && rows[0].every(c=>c==='')) rows.shift();
  while(rows.length && rows[rows.length-1].every(c=>c==='')) rows.pop();
  if(rows.length===0){
    document.getElementById('table-container').innerHTML='CSV vacÃ­o';
    return;
  }

  const headerRowsCount = 2;
  const headerRows = rows.slice(0,headerRowsCount);
  const dataRows = rows.slice(headerRowsCount);

  const cols = Math.max(...rows.map(r=>r.length));

  rows = rows.map(r=>{
    const copy = r.slice(0,cols);
    while(copy.length<cols) copy.push('');
    return copy;
  });

  const persons = [];
  for(let i=0;i<dataRows.length;i+=3){
    const A = dataRows[i] || new Array(cols).fill('');
    const B = dataRows[i+1] || new Array(cols).fill('');
    const C = dataRows[i+2] || new Array(cols).fill('');
    persons.push({A,B,C});
  }

  let html = '<table>';

  for(let r=0;r<headerRowsCount;r++){
    html+='<tr>';
    for(let c=0;c<cols;c++){
      html+='<th>'+escapeHtml(headerRows[r][c]||'')+'</th>';
    }
    html+='</tr>';
  }

  persons.forEach(p=>{
    const A = p.A, B=p.B, C=p.C;

    html+='<tr>';
    html+='<td class="name" rowspan="2">'+escapeHtml(A[0]||'')+'</td>';
    const rowspanCols = [];
    for(let c=1;c<cols;c++){
      const top = A[c]||'';
      const bot = B[c]||'';

      if(top.toUpperCase().includes('FERIAS')){
        let spanCount = 1;
        for(let k=c+1;k<cols;k++){
          if((A[k]||'').trim()==='' && (B[k]||'').trim()==='') spanCount++;
          else break;
        }
        html+='<td class="multi-line" colspan="'+spanCount+'" style="text-align:center;">'+escapeHtml(top)+'</td>';
        c += spanCount-1;
      } else if(top!==''||bot!==''){
        let content = [top,bot].filter(v=>v!=='').map(escapeHtml).join('<br>');
        html+='<td class="multi-line" rowspan="2">'+content+'</td>';
        rowspanCols.push(c);
      } else {
        html+='<td></td>';
      }
    }
    html+='</tr>';

    html+='<tr>';
    for(let c=1;c<cols;c++){
      if(rowspanCols.includes(c)) continue;
      html+='<td></td>';
    }
    html+='</tr>';

    html+='<tr>';
    for(let c=0;c<cols;c++){
      html+='<td class="bold-row">'+escapeHtml(C[c]||'')+'</td>';
    }
    html+='</tr>';
  });

  html+='</table>';
  document.getElementById('table-container').innerHTML = html;

  function escapeHtml(str){
    return String(str).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
  }

})();
</script>



</body></html>